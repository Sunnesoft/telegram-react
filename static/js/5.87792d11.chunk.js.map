{"version":3,"sources":["Components/ColumnMiddle/StickerSet.js","Utils/Animatior.js","Components/ColumnMiddle/StickersPickerHeader.js","Components/ColumnMiddle/StickersPicker.js","Components/ColumnMiddle/EmojiPickerButton.js"],"names":["StickerSet","nextProps","nextState","nextContext","_this$props","this","props","info","theme","_this$props2","classes","onSelect","onMouseDown","onMouseOver","title","items","stickers","map","x","i","react_default","a","createElement","className","classNames","stickerSetItem","key","sticker","id","data-sticker-id","onClick","Sticker","preview","displaySize","STICKER_SMALL_DISPLAY_SIZE","blur","React","Component","withStyles","backgroundColor","palette","background","paper","color","text","primary","width","height","padding","boxSizing","&:hover","type","borderRadius","withTheme","Animator","duration","_this","options","arguments","length","undefined","Object","classCallCheck","start","stopped","requestAnimationFrame","startAnim","timeStamp","end","draw","now","p","val","outSine","forEach","from","to","func","stop","cancelAnimationFrame","n","Math","sin","PI","StickersPickerHeader","possibleConstructorReturn","getPrototypeOf","call","onClientUpdateStickerSetPosition","update","position","setState","scrollToPosition","state","_assertThisInitialize","assertThisInitialized","animator","anchorRef","scroll","scrollRef","current","anchor","anchorNode","ReactDOM","scrollFrom","scrollLeft","scrollTo","anchorFrom","Number","style","left","replace","anchorTo","ANIMATION_DURATION_500MS","abs","sign","handleWheel","event","deltaX","deltaY","handleSelect","indexOf","createRef","StickerStore","on","removeListener","prevProps","prevState","snapshot","_this2","openMedia","borderColor","ref","onWheel","accentBackgroundDark","objectSpread","borderStyle","accentStyles","StickersPicker","scrollTop","loadContent","_ref","asyncToGenerator","regenerator_default","mark","_callee","stickerSets","sets","result","promises","slicedSets","headerStickers","wrap","_context","prev","next","abrupt","TdLibController","send","@type","is_masks","sent","push","set_id","Promise","all","slice","reduce","set","setsLength","_x","_x2","apply","loadInViewContentOnScroll","loadInViewContent","loadInViewContentOnScrollEnd","inViewItems","item","itemsMap","get","node","topBorder","bottomBorder","offsetHeight","nodeTop","offsetTop","nodeBottom","clientHeight","store","FileStore","getStore","loadedSets","has","loadStickerSetContent","updatePosition","minDiff","scrollHeight","firstOffsetTop","pos","element","diff","clientUpdate","handleScroll","_callee2","loadChunk","_this$state","concatSets","_context2","loadingChunk","finally","concat","loadPreviewContent","stickerId","getStickers","find","loadStickerContent","getNeighborStickersFromSets","handleMouseOver","target","dataset","mouseDown","mouseDownStickerId","previewStickerId","onPreview","handleMouseDown","Date","timestamp","showPreview","cancelSend","setTimeout","document","addEventListener","handleMouseUp","preventDefault","stopPropagation","removeEventListener","handleStickerSelect","handleSelectSet","_ref3","_callee3","_this$state2","_context3","_x3","Map","debounce","throttle","_this$state3","_this$state4","clear","Components_ColumnMiddle_StickerSet","el","Components_ColumnMiddle_StickersPickerHeader","onScroll","EmojiPickerButton","onClientUpdateChange","picker","handleButtonMouseEnter","buttonEnter","updatePicker","loadStickerSets","EMOJI_PICKER_TIMEOUT_MS","stickersPickerRef","reverse","loadStickerThumbnailContent","handleButtonMouseLeave","tryClosePicker","paperEnter","handlePaperMouseEnter","handlePaperMouseLeave","open","switchPicker","handleEmojiClick","tab","handleStickersClick","stickersPicker","handleStickerSend","handleStickerPreview","emojiPickerRef","ApplicationStore","LocalizationStore","t","i18n","search","notfound","skintext","categories","recent","people","nature","foods","activity","places","objects","symbols","flags","custom","dist_es","showSkinTones","dark","overflowX","Components_ColumnMiddle_StickersPicker","Fragment","rel","href","IconButton_default","iconButton","aria-label","onMouseEnter","onMouseLeave","InsertEmoticon_default","pickerRoot","defineProperty","pickerRootOpened","Button_default","headerButton","emoji-picker-content-stickers","StickerPreview","enhance","compose","margin","flex","zIndex","modal","shape","boxShadow","shadows","bottom","display","withTranslation"],"mappings":"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","file":"static/js/5.87792d11.chunk.js","sourcesContent":["/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport withStyles from '@material-ui/core/styles/withStyles';\r\nimport Sticker from '../Message/Media/Sticker';\r\nimport { STICKER_SMALL_DISPLAY_SIZE } from '../../Constants';\r\nimport './StickerSet.css';\r\n\r\nconst styles = theme => ({\r\n    title: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        color: theme.palette.text.primary\r\n    },\r\n    stickerSetItem: {\r\n        width: STICKER_SMALL_DISPLAY_SIZE,\r\n        height: STICKER_SMALL_DISPLAY_SIZE,\r\n        padding: 3,\r\n        boxSizing: 'border-box',\r\n        '&:hover': {\r\n            background: theme.palette.type === 'dark' ? '#303030' : '#f4f4f4',\r\n            borderRadius: 6\r\n        }\r\n    }\r\n});\r\n\r\nclass StickerSet extends React.Component {\r\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n        const { info, theme } = this.props;\r\n\r\n        if (theme !== nextProps.theme) {\r\n            return true;\r\n        }\r\n\r\n        if (info !== nextProps.info) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    render() {\r\n        const { classes, info, onSelect, onMouseDown, onMouseOver } = this.props;\r\n        if (!info) return null;\r\n\r\n        const { title, stickers } = info;\r\n\r\n        const items = stickers.map((x, i) => (\r\n            <div\r\n                className={classNames('sticker-set-item', classes.stickerSetItem)}\r\n                key={x.sticker.id}\r\n                data-sticker-id={x.sticker.id}\r\n                onClick={() => onSelect(x)}\r\n                onMouseDown={onMouseDown}\r\n                onMouseOver={onMouseOver}>\r\n                <Sticker\r\n                    key={x.sticker.id}\r\n                    className='sticker-set-item-sticker'\r\n                    sticker={x}\r\n                    preview\r\n                    displaySize={STICKER_SMALL_DISPLAY_SIZE - 6}\r\n                    blur={false}\r\n                />\r\n            </div>\r\n        ));\r\n\r\n        return (\r\n            <div className='sticker-set'>\r\n                <div className={classNames('sticker-set-title', classes.title)}>\r\n                    <span>{title}</span>\r\n                </div>\r\n                <div className='sticker-set-content'>{items}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nStickerSet.propTypes = {\r\n    info: PropTypes.object.isRequired,\r\n    onSelect: PropTypes.func.isRequired,\r\n    onMouseDown: PropTypes.func.isRequired\r\n};\r\n\r\nexport default withStyles(styles, { withTheme: true })(StickerSet);\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nclass Animator {\r\n    constructor(duration, options = []) {\r\n        this.options = options;\r\n        this.duration = duration;\r\n    }\r\n\r\n    static outSine(n) {\r\n        return Math.sin((n * Math.PI) / 2);\r\n    }\r\n\r\n    start = () => {\r\n        this.stopped = false;\r\n        this.id = requestAnimationFrame(this.startAnim);\r\n    };\r\n\r\n    startAnim = timeStamp => {\r\n        const { start, duration } = this;\r\n\r\n        this.start = timeStamp;\r\n        this.end = start + duration;\r\n        this.draw(timeStamp);\r\n    };\r\n\r\n    draw = now => {\r\n        const { stopped, duration, start, options } = this;\r\n\r\n        if (stopped) return;\r\n        if (now - start >= duration) this.stopped = true;\r\n\r\n        const p = (now - start) / duration;\r\n        const val = Animator.outSine(p);\r\n\r\n        options.forEach(x => {\r\n            const { from, to, func } = x;\r\n            func(from + (to - from) * val);\r\n        });\r\n\r\n        this.id = requestAnimationFrame(this.draw);\r\n    };\r\n\r\n    stop = () => {\r\n        this.stopped = true;\r\n        cancelAnimationFrame(this.id);\r\n    };\r\n}\r\n\r\nexport default Animator;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport withStyles from '@material-ui/core/styles/withStyles';\r\nimport Animator from '../../Utils/Animatior';\r\nimport Sticker from './../Message/Media/Sticker';\r\nimport { accentStyles, borderStyle } from '../Theme';\r\nimport { ANIMATION_DURATION_500MS } from '../../Constants';\r\nimport StickerStore from '../../Stores/StickerStore';\r\nimport './StickersPickerHeader.css';\r\n\r\nconst styles = theme => ({\r\n    ...borderStyle(theme),\r\n    ...accentStyles(theme)\r\n});\r\n\r\nclass StickersPickerHeader extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = { position: 0 };\r\n\r\n        this.scrollRef = React.createRef();\r\n        this.anchorRef = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        StickerStore.on('clientUpdateStickerSetPosition', this.onClientUpdateStickerSetPosition);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        StickerStore.removeListener('clientUpdateStickerSetPosition', this.onClientUpdateStickerSetPosition);\r\n    }\r\n\r\n    onClientUpdateStickerSetPosition = update => {\r\n        const { position } = update;\r\n\r\n        this.setState({ position });\r\n    };\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (prevState.position !== this.state.position) {\r\n            this.scrollToPosition();\r\n        }\r\n    }\r\n\r\n    scrollToPosition = () => {\r\n        const { position } = this.state;\r\n        const { animator, anchorRef, scrollRef } = this;\r\n\r\n        const scroll = scrollRef.current;\r\n        const anchor = anchorRef.current;\r\n        const anchorNode = ReactDOM.findDOMNode(anchor);\r\n\r\n        const scrollFrom = scroll.scrollLeft;\r\n        const scrollTo = position * 44 - 147;\r\n\r\n        const anchorFrom = Number(anchorNode.style.left.replace('px', ''));\r\n        const anchorTo = position * 44;\r\n\r\n        if (animator) {\r\n            animator.stop();\r\n        }\r\n        this.animator = new Animator(ANIMATION_DURATION_500MS, [\r\n            {\r\n                from: scrollFrom,\r\n                to: scrollTo,\r\n                func: left => (scroll.scrollLeft = left)\r\n            },\r\n            {\r\n                from:\r\n                    Math.abs(anchorTo - anchorFrom) > 338\r\n                        ? anchorTo - Math.sign(anchorTo - anchorFrom) * 338\r\n                        : anchorFrom,\r\n                to: anchorTo,\r\n                func: left => (anchorNode.style.left = left + 'px')\r\n            }\r\n        ]);\r\n        this.animator.start();\r\n    };\r\n\r\n    handleWheel = event => {\r\n        const { scrollRef } = this;\r\n\r\n        if (event.deltaX === 0) {\r\n            const scroll = scrollRef.current;\r\n\r\n            scroll.scrollLeft += event.deltaY;\r\n        }\r\n    };\r\n\r\n    handleSelect = sticker => {\r\n        const { stickers, onSelect } = this.props;\r\n\r\n        onSelect(stickers.indexOf(sticker));\r\n    };\r\n\r\n    render() {\r\n        const { classes, stickers } = this.props;\r\n\r\n        const items = stickers.map(x => (\r\n            <Sticker\r\n                key={x.sticker.id}\r\n                className='stickers-picker-header-sticker'\r\n                preview\r\n                sticker={x}\r\n                displaySize={32}\r\n                blur={false}\r\n                openMedia={() => this.handleSelect(x)}\r\n            />\r\n        ));\r\n\r\n        return (\r\n            <div className={classNames('stickers-picker-header', classes.borderColor)}>\r\n                <div ref={this.scrollRef} className='stickers-picker-header-scroll' onWheel={this.handleWheel}>\r\n                    <div className='stickers-picker-header-items'>{items}</div>\r\n                    <div\r\n                        ref={this.anchorRef}\r\n                        className={classNames('stickers-picker-header-anchor', classes.accentBackgroundDark)}\r\n                    />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nStickersPickerHeader.propTypes = {\r\n    stickers: PropTypes.array.isRequired,\r\n    onSelect: PropTypes.func.isRequired\r\n};\r\n\r\nexport default withStyles(styles)(StickersPickerHeader);\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport PropTypes from 'prop-types';\r\nimport StickerSet from './StickerSet';\r\nimport StickersPickerHeader from './StickersPickerHeader';\r\nimport { debounce, throttle } from '../../Utils/Common';\r\nimport { loadStickerContent, loadStickerSetContent } from '../../Utils/File';\r\nimport { getNeighborStickersFromSets, getStickers } from '../../Utils/Media';\r\nimport FileStore from '../../Stores/FileStore';\r\nimport TdLibController from '../../Controllers/TdLibController';\r\nimport './StickersPicker.css';\r\n\r\nclass StickersPicker extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.scrollRef = React.createRef();\r\n        this.itemsMap = new Map();\r\n        this.loadedSets = new Map();\r\n\r\n        this.state = {\r\n            stickerSets: null,\r\n            sets: [],\r\n            headerStickers: [],\r\n            position: 0\r\n        };\r\n\r\n        this.loadInViewContentOnScrollEnd = debounce(this.loadInViewContentOnScrollEnd, 100);\r\n        this.loadInViewContentOnScroll = throttle(this.loadInViewContentOnScroll, 2000);\r\n        this.updatePosition = throttle(this.updatePosition, 250);\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n        const { position, stickerSets, sets, showPreview } = this.state;\r\n\r\n        if (nextState.stickerSets !== stickerSets) {\r\n            return true;\r\n        }\r\n\r\n        if (nextState.sets !== sets) {\r\n            return true;\r\n        }\r\n\r\n        if (nextState.showPreview !== showPreview) {\r\n            return true;\r\n        }\r\n\r\n        if (nextState.position !== position) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    scrollTop = () => {\r\n        this.scrollRef.current.scrollTop = 0;\r\n    };\r\n\r\n    loadContent = async (stickerSets, sets) => {\r\n        if (this.state.stickerSets) return;\r\n\r\n        if (!sets) {\r\n            const result = await TdLibController.send({\r\n                '@type': 'getInstalledStickerSets',\r\n                is_masks: false\r\n            });\r\n\r\n            const promises = [];\r\n            result.sets.forEach(x => {\r\n                promises.push(\r\n                    TdLibController.send({\r\n                        '@type': 'getStickerSet',\r\n                        set_id: x.id\r\n                    })\r\n                );\r\n            });\r\n\r\n            sets = await Promise.all(promises);\r\n        }\r\n\r\n        const slicedSets = sets.slice(0, 5);\r\n        const headerStickers = sets.reduce((preview, set) => {\r\n            if (set.stickers.length > 0) {\r\n                preview.push(set.stickers[0]);\r\n            }\r\n            return preview;\r\n        }, []);\r\n        this.setState({\r\n            stickerSets,\r\n            sets: slicedSets,\r\n            headerStickers\r\n        });\r\n        this.setsLength = slicedSets.length;\r\n    };\r\n\r\n    loadInViewContentOnScroll = () => {\r\n        this.loadInViewContent();\r\n    };\r\n\r\n    loadInViewContentOnScrollEnd = () => {\r\n        this.loadInViewContent(400);\r\n    };\r\n\r\n    loadInViewContent = (padding = 0) => {\r\n        const scroll = this.scrollRef.current;\r\n\r\n        const { sets } = this.state;\r\n\r\n        const inViewItems = [];\r\n        sets.forEach(x => {\r\n            const item = this.itemsMap.get(x.id);\r\n            const node = ReactDOM.findDOMNode(item);\r\n            if (node) {\r\n                const topBorder = scroll.scrollTop - padding;\r\n                const bottomBorder = scroll.scrollTop + scroll.offsetHeight + padding;\r\n\r\n                const nodeTop = node.offsetTop;\r\n                const nodeBottom = node.offsetTop + node.clientHeight;\r\n\r\n                if (nodeTop >= topBorder && node.offsetTop <= bottomBorder) {\r\n                    inViewItems.push(x);\r\n                } else if (nodeBottom >= topBorder && nodeBottom <= bottomBorder) {\r\n                    inViewItems.push(x);\r\n                } else if (nodeTop <= topBorder && nodeBottom >= bottomBorder) {\r\n                    inViewItems.push(x);\r\n                }\r\n            }\r\n        });\r\n\r\n        inViewItems.forEach(x => {\r\n            const store = FileStore.getStore();\r\n            if (!this.loadedSets.has(x.id)) {\r\n                this.loadedSets.set(x.id, x.id);\r\n                loadStickerSetContent(store, x);\r\n            }\r\n        });\r\n    };\r\n\r\n    updatePosition = () => {\r\n        const scroll = this.scrollRef.current;\r\n\r\n        const { sets } = this.state;\r\n        let minDiff = scroll.scrollHeight;\r\n        let position = 0;\r\n        let firstOffsetTop = 0;\r\n        sets.forEach((x, pos) => {\r\n            const element = this.itemsMap.get(x.id);\r\n            if (element) {\r\n                const node = ReactDOM.findDOMNode(element);\r\n                if (node) {\r\n                    firstOffsetTop = pos === 0 ? node.offsetTop : firstOffsetTop;\r\n\r\n                    const offsetTop = node.offsetTop - firstOffsetTop;\r\n                    if (node && offsetTop <= scroll.scrollTop) {\r\n                        const diff = Math.abs(scroll.scrollTop - offsetTop);\r\n                        if (diff <= minDiff) {\r\n                            minDiff = diff;\r\n                            position = pos;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        TdLibController.clientUpdate({\r\n            '@type': 'clientUpdateStickerSetPosition',\r\n            position\r\n        });\r\n        this.setState({ position });\r\n    };\r\n\r\n    handleScroll = async () => {\r\n        //this.loadInViewContentOnScroll();\r\n        this.loadInViewContentOnScrollEnd();\r\n        this.updatePosition();\r\n\r\n        const scroll = this.scrollRef.current;\r\n\r\n        if (this.loadingChunk) return;\r\n\r\n        let loadChunk = false;\r\n        if (scroll.scrollTop + scroll.offsetHeight >= scroll.scrollHeight - 400) {\r\n            loadChunk = true;\r\n        }\r\n\r\n        if (!loadChunk) {\r\n            return false;\r\n        }\r\n\r\n        const { sets, stickerSets } = this.state;\r\n        if (stickerSets.sets.length === sets.length) return;\r\n\r\n        this.loadingChunk = true;\r\n        const promises = [];\r\n        stickerSets.sets.slice(this.setsLength, this.setsLength + 5).forEach(x => {\r\n            promises.push(\r\n                TdLibController.send({\r\n                    '@type': 'getStickerSet',\r\n                    set_id: x.id\r\n                })\r\n            );\r\n        });\r\n\r\n        const result = await Promise.all(promises).finally(() => (this.loadingChunk = false));\r\n\r\n        this.setsLength += result.length;\r\n        let concatSets = sets.concat(result);\r\n        this.setState({ sets: concatSets });\r\n    };\r\n\r\n    loadPreviewContent = stickerId => {\r\n        const { sets } = this.state;\r\n\r\n        const sticker = getStickers(sets).find(x => x.sticker.id === stickerId);\r\n        if (!sticker) return;\r\n\r\n        const store = FileStore.getStore();\r\n        loadStickerContent(store, sticker, null);\r\n\r\n        const stickersPerRow = 5;\r\n        const preloadStickers = getNeighborStickersFromSets(sticker, sets, stickersPerRow);\r\n        preloadStickers.forEach(x => {\r\n            loadStickerContent(store, x, null);\r\n        });\r\n    };\r\n\r\n    handleMouseOver = event => {\r\n        const stickerId = Number(event.target.dataset.stickerId);\r\n        if (!stickerId) return;\r\n\r\n        if (!this.mouseDown) return;\r\n\r\n        if (this.mouseDownStickerId !== stickerId) {\r\n            this.mouseDownStickerId = null;\r\n        }\r\n        this.setState({ previewStickerId: stickerId });\r\n        this.loadPreviewContent(stickerId);\r\n\r\n        const { onPreview } = this.props;\r\n        const { sets } = this.state;\r\n\r\n        const sticker = getStickers(sets).find(x => x.sticker.id === stickerId);\r\n        onPreview(sticker);\r\n    };\r\n\r\n    handleMouseDown = event => {\r\n        const stickerId = Number(event.target.dataset.stickerId);\r\n        if (!stickerId) return;\r\n\r\n        this.mouseDownStickerId = stickerId;\r\n        const now = Date.now();\r\n\r\n        this.setState({ previewStickerId: stickerId, timestamp: now, showPreview: false, cancelSend: false });\r\n        setTimeout(() => {\r\n            const { timestamp } = this.state;\r\n            if (timestamp === now) {\r\n                this.setState({ showPreview: true, cancelSend: true }, () => {\r\n                    const { onPreview } = this.props;\r\n                    const { sets } = this.state;\r\n\r\n                    const sticker = getStickers(sets).find(x => x.sticker.id === stickerId);\r\n                    onPreview(sticker);\r\n                });\r\n            }\r\n        }, 500);\r\n\r\n        this.loadPreviewContent(stickerId);\r\n\r\n        this.mouseDown = true;\r\n        document.addEventListener('mouseup', this.handleMouseUp);\r\n\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        return false;\r\n    };\r\n\r\n    handleMouseUp = () => {\r\n        this.setState({ previewStickerId: 0, timestamp: 0, showPreview: false });\r\n\r\n        const { onPreview } = this.props;\r\n\r\n        onPreview(null);\r\n\r\n        this.mouseDown = false;\r\n        document.removeEventListener('mouseup', this.handleMouseUp);\r\n    };\r\n\r\n    handleStickerSelect = sticker => {\r\n        const { onSelect } = this.props;\r\n        const { cancelSend } = this.state;\r\n\r\n        if (cancelSend) return;\r\n\r\n        onSelect(sticker);\r\n    };\r\n\r\n    handleSelectSet = async position => {\r\n        const { sets, stickerSets } = this.state;\r\n        const { scrollRef } = this;\r\n\r\n        if (position < sets.length) {\r\n            const element = this.itemsMap.get(sets[position].id);\r\n            if (element) {\r\n                const node = ReactDOM.findDOMNode(element);\r\n                if (node) {\r\n                    const scroll = scrollRef.current;\r\n                    scroll.scrollTop = node.offsetTop;\r\n                }\r\n            }\r\n        } else if (position < stickerSets.sets.length) {\r\n            if (this.loadingChunk) return;\r\n            if (stickerSets.sets.length === sets.length) return;\r\n\r\n            this.loadingChunk = true;\r\n            const promises = [];\r\n            stickerSets.sets.slice(this.setsLength, position + 1).forEach(x => {\r\n                promises.push(\r\n                    TdLibController.send({\r\n                        '@type': 'getStickerSet',\r\n                        set_id: x.id\r\n                    })\r\n                );\r\n            });\r\n\r\n            const result = await Promise.all(promises).finally(() => (this.loadingChunk = false));\r\n\r\n            this.setsLength += result.length;\r\n            let concatSets = sets.concat(result);\r\n            this.setState({ sets: concatSets }, () => {\r\n                if (position < concatSets.length) {\r\n                    this.handleSelectSet(position);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { position, stickerSets, sets, headerStickers } = this.state;\r\n        if (!stickerSets) return null;\r\n\r\n        if (!sets) return null;\r\n        if (!sets.length) return null;\r\n\r\n        this.itemsMap.clear();\r\n        const items = sets.map(x => (\r\n            <StickerSet\r\n                key={x.id}\r\n                ref={el => this.itemsMap.set(x.id, el)}\r\n                info={x}\r\n                onSelect={this.handleStickerSelect}\r\n                onMouseDown={this.handleMouseDown}\r\n                onMouseOver={this.handleMouseOver}\r\n            />\r\n        ));\r\n\r\n        return (\r\n            <div className='stickers-picker'>\r\n                <StickersPickerHeader onSelect={this.handleSelectSet} stickers={headerStickers} />\r\n                <div ref={this.scrollRef} className='stickers-picker-scroll' onScroll={this.handleScroll}>\r\n                    {items}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nStickersPicker.propTypes = {\r\n    onSelect: PropTypes.func.isRequired,\r\n    onPreview: PropTypes.func.isRequired\r\n};\r\n\r\nexport default StickersPicker;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport classNames from 'classnames';\r\nimport { compose } from 'recompose';\r\nimport withStyles from '@material-ui/core/styles/withStyles';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Button from '@material-ui/core/Button';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport { Picker as EmojiPicker } from 'emoji-mart';\r\nimport StickerPreview from './StickerPreview';\r\nimport StickersPicker from './StickersPicker';\r\nimport { loadStickerThumbnailContent, loadStickerSetContent } from '../../Utils/File';\r\nimport { EMOJI_PICKER_TIMEOUT_MS } from '../../Constants';\r\nimport ApplicationStore from '../../Stores/ApplicationStore';\r\nimport FileStore from '../../Stores/FileStore';\r\nimport LocalizationStore from '../../Stores/LocalizationStore';\r\nimport TdLibController from '../../Controllers/TdLibController';\r\nimport './EmojiPickerButton.css';\r\n\r\nconst styles = theme => ({\r\n    iconButton: {\r\n        margin: '8px 0px'\r\n    },\r\n    headerButton: {\r\n        borderRadius: 0,\r\n        flex: '50%'\r\n    },\r\n    pickerRoot: {\r\n        zIndex: theme.zIndex.modal,\r\n        width: 338,\r\n        overflowX: 'hidden',\r\n        backgroundColor: theme.palette.background.paper,\r\n        color: theme.palette.text.primary,\r\n        borderRadius: theme.shape.borderRadius,\r\n        boxShadow: theme.shadows[8],\r\n        position: 'absolute',\r\n        bottom: 80,\r\n        display: 'none'\r\n    },\r\n    pickerRootOpened: {\r\n        display: 'block'\r\n    }\r\n});\r\n\r\nclass EmojiPickerButton extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            open: false,\r\n            tab: 0\r\n        };\r\n\r\n        this.emojiPickerRef = React.createRef();\r\n        this.stickersPickerRef = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        ApplicationStore.on('clientUpdateThemeChange', this.onClientUpdateChange);\r\n        LocalizationStore.on('clientUpdateLanguageChange', this.onClientUpdateChange);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        ApplicationStore.removeListener('clientUpdateThemeChange', this.onClientUpdateChange);\r\n        LocalizationStore.removeListener('clientUpdateLanguageChange', this.onClientUpdateChange);\r\n    }\r\n\r\n    onClientUpdateChange = update => {\r\n        this.picker = null;\r\n    };\r\n\r\n    handleButtonMouseEnter = event => {\r\n        this.buttonEnter = true;\r\n        setTimeout(() => {\r\n            if (!this.buttonEnter) return;\r\n\r\n            this.updatePicker(true);\r\n            this.loadStickerSets();\r\n        }, EMOJI_PICKER_TIMEOUT_MS);\r\n    };\r\n\r\n    loadStickerSets = async () => {\r\n        if (this.sets) return;\r\n\r\n        this.stickerSets = await TdLibController.send({\r\n            '@type': 'getInstalledStickerSets',\r\n            is_masks: false\r\n        });\r\n\r\n        const promises = [];\r\n        this.stickerSets.sets.forEach(x => {\r\n            promises.push(\r\n                TdLibController.send({\r\n                    '@type': 'getStickerSet',\r\n                    set_id: x.id\r\n                })\r\n            );\r\n        });\r\n\r\n        this.sets = await Promise.all(promises);\r\n\r\n        const node = this.stickersPickerRef.current;\r\n\r\n        const store = FileStore.getStore();\r\n        const previewSets = this.sets.slice(0, 5).reverse();\r\n        previewSets.forEach(x => {\r\n            loadStickerSetContent(store, x);\r\n            node.loadedSets.set(x.id, x.id);\r\n        });\r\n\r\n        const previewStickers = this.sets.reduce((stickers, set) => {\r\n            if (set.stickers.length > 0) {\r\n                stickers.push(set.stickers[0]);\r\n            }\r\n            return stickers;\r\n        }, []);\r\n        previewStickers.forEach(x => {\r\n            loadStickerThumbnailContent(store, x);\r\n        });\r\n    };\r\n\r\n    handleButtonMouseLeave = () => {\r\n        this.buttonEnter = false;\r\n        setTimeout(() => {\r\n            this.tryClosePicker();\r\n        }, EMOJI_PICKER_TIMEOUT_MS);\r\n    };\r\n\r\n    tryClosePicker = () => {\r\n        const { sticker } = this.state;\r\n        if (this.paperEnter || this.buttonEnter || sticker) return;\r\n\r\n        this.updatePicker(false);\r\n    };\r\n\r\n    handlePaperMouseEnter = () => {\r\n        this.paperEnter = true;\r\n    };\r\n\r\n    handlePaperMouseLeave = () => {\r\n        this.paperEnter = false;\r\n        setTimeout(() => {\r\n            this.tryClosePicker();\r\n        }, EMOJI_PICKER_TIMEOUT_MS);\r\n    };\r\n\r\n    updatePicker = open => {\r\n        this.setState({ open });\r\n    };\r\n\r\n    switchPicker = () => {\r\n        this.updatePicker(!this.state.open);\r\n    };\r\n\r\n    handleEmojiClick = () => {\r\n        this.setState({ tab: 0 });\r\n    };\r\n\r\n    handleStickersClick = () => {\r\n        const stickersPicker = this.stickersPickerRef.current;\r\n        const { tab } = this.state;\r\n\r\n        stickersPicker.loadContent(this.stickerSets, this.sets);\r\n\r\n        this.setState({ tab: 1 });\r\n        if (tab === 1) {\r\n            stickersPicker.scrollTop();\r\n        }\r\n    };\r\n\r\n    handleStickerSend = sticker => {\r\n        if (!sticker) return;\r\n\r\n        TdLibController.clientUpdate({\r\n            '@type': 'clientUpdateStickerSend',\r\n            sticker\r\n        });\r\n\r\n        this.updatePicker(false);\r\n    };\r\n\r\n    handleStickerPreview = sticker => {\r\n        this.setState({ sticker });\r\n\r\n        if (!sticker) {\r\n            this.tryClosePicker();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { classes, theme, t } = this.props;\r\n        const { open, tab, sticker } = this.state;\r\n\r\n        if (open && !this.picker) {\r\n            const i18n = {\r\n                search: t('Search'),\r\n                notfound: t('NotEmojiFound'),\r\n                skintext: t('ChooseDefaultSkinTone'),\r\n                categories: {\r\n                    search: t('SearchResults'),\r\n                    recent: t('Recent'),\r\n                    people: t('SmileysPeople'),\r\n                    nature: t('AnimalsNature'),\r\n                    foods: t('FoodDrink'),\r\n                    activity: t('Activity'),\r\n                    places: t('TravelPlaces'),\r\n                    objects: t('Objects'),\r\n                    symbols: t('Symbols'),\r\n                    flags: t('Flags'),\r\n                    custom: t('Custom')\r\n                }\r\n            };\r\n\r\n            this.picker = (\r\n                <EmojiPicker\r\n                    ref={this.emojiPickerRef}\r\n                    set='apple'\r\n                    showPreview={false}\r\n                    showSkinTones={false}\r\n                    onSelect={this.props.onSelect}\r\n                    color={theme.palette.primary.dark}\r\n                    i18n={i18n}\r\n                    style={{ width: 338, overflowX: 'hidden' }}\r\n                />\r\n            );\r\n\r\n            this.stickersPicker = (\r\n                <StickersPicker\r\n                    ref={this.stickersPickerRef}\r\n                    onSelect={this.handleStickerSend}\r\n                    onPreview={this.handleStickerPreview}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <link\r\n                    rel='stylesheet'\r\n                    type='text/css'\r\n                    href={theme.palette.type === 'dark' ? 'emoji-mart.dark.css' : 'emoji-mart.light.css'}\r\n                />\r\n                <IconButton\r\n                    className={classes.iconButton}\r\n                    aria-label='Emoticon'\r\n                    onClick={this.switchPicker}\r\n                    onMouseEnter={this.handleButtonMouseEnter}\r\n                    onMouseLeave={this.handleButtonMouseLeave}>\r\n                    <InsertEmoticonIcon />\r\n                </IconButton>\r\n                <div\r\n                    className={classNames(classes.pickerRoot, { [classes.pickerRootOpened]: open })}\r\n                    onMouseEnter={this.handlePaperMouseEnter}\r\n                    onMouseLeave={this.handlePaperMouseLeave}>\r\n                    <div className='emoji-picker-header'>\r\n                        <Button\r\n                            color={tab === 0 ? 'primary' : 'default'}\r\n                            className={classes.headerButton}\r\n                            onClick={this.handleEmojiClick}>\r\n                            {t('Emoji')}\r\n                        </Button>\r\n                        <Button\r\n                            color={tab === 1 ? 'primary' : 'default'}\r\n                            className={classes.headerButton}\r\n                            onClick={this.handleStickersClick}>\r\n                            {t('Stickers')}\r\n                        </Button>\r\n                    </div>\r\n                    <div className={classNames('emoji-picker-content', { 'emoji-picker-content-stickers': tab === 1 })}>\r\n                        {this.picker}\r\n                        {this.stickersPicker}\r\n                    </div>\r\n                    <StickerPreview sticker={sticker} />\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nconst enhance = compose(\r\n    withStyles(styles, { withTheme: true }),\r\n    withTranslation()\r\n);\r\n\r\nexport default enhance(EmojiPickerButton);\r\n"],"sourceRoot":""}